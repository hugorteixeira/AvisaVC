{"ast":null,"code":"var _jsxFileName = \"/home/hugorteixeira/AvisoVC/frontend/src/pages/TestFacial.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useApp } from '../contexts/AppContext';\nimport { FaceDetector, drawLandmarks } from '../utils/faceDetection';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function TestFacial() {\n  _s();\n  const navigate = useNavigate();\n  const {\n    baselineFace\n  } = useApp();\n  const [status, setStatus] = useState('init'); // init, ready, testing, analyzing, result, error\n  const [testDuration, setTestDuration] = useState(0);\n  const [detectionResult, setDetectionResult] = useState(null);\n  const [currentStatus, setCurrentStatus] = useState('');\n  const [error, setError] = useState(null);\n  const [streamVersion, setStreamVersion] = useState(0);\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const faceDetectorRef = useRef(null);\n  const streamRef = useRef(null);\n  const animationFrameRef = useRef(null);\n  const timerRef = useRef(null);\n  useEffect(() => {\n    initializeTest();\n    return () => {\n      cleanup();\n    };\n  }, []);\n  const initializeTest = async () => {\n    try {\n      console.log('üé¨ Initializing test facial...');\n\n      // Check if baseline exists\n      if (!baselineFace) {\n        console.error('‚ùå No baseline face found');\n        setError('Voc√™ precisa criar um perfil facial primeiro');\n        setStatus('error');\n        return;\n      }\n      console.log('‚úÖ Baseline exists:', baselineFace);\n\n      // Initialize camera\n      console.log('üìπ Requesting camera access...');\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'user',\n          width: {\n            ideal: 720\n          },\n          height: {\n            ideal: 540\n          }\n        },\n        audio: false\n      });\n      console.log('‚úÖ Camera access granted');\n      streamRef.current = stream;\n      if (videoRef.current) {\n        console.log('üé• Setting up video element...');\n\n        // Clear any previous srcObject\n        if (videoRef.current.srcObject) {\n          console.log('‚ö†Ô∏è Clearing previous video source');\n          videoRef.current.srcObject = null;\n        }\n        videoRef.current.srcObject = stream;\n        await new Promise(resolve => {\n          videoRef.current.onloadedmetadata = () => {\n            console.log('‚úÖ Video metadata loaded');\n            resolve();\n          };\n        });\n\n        // Ensure video is ready to play\n        try {\n          await videoRef.current.play();\n          console.log('‚úÖ Video playing');\n        } catch (playError) {\n          console.error('‚ùå Error playing video:', playError);\n          throw new Error('N√£o foi poss√≠vel reproduzir o v√≠deo da c√¢mera.');\n        }\n\n        // Wait for video to have valid dimensions\n        console.log('‚è≥ Waiting for video dimensions...');\n        await new Promise((resolve, reject) => {\n          let attempts = 0;\n          const maxAttempts = 50; // 5 seconds max\n          const checkDimensions = () => {\n            attempts++;\n            if (videoRef.current && videoRef.current.videoWidth > 0 && videoRef.current.videoHeight > 0) {\n              console.log(`‚úÖ Video dimensions: ${videoRef.current.videoWidth}x${videoRef.current.videoHeight}`);\n              resolve();\n            } else if (attempts >= maxAttempts) {\n              console.error(`‚ùå Timeout waiting for video dimensions after ${attempts} attempts`);\n              reject(new Error('Timeout esperando dimens√µes do v√≠deo. Tente recarregar a p√°gina.'));\n            } else {\n              console.log(`‚è≥ Video dimensions not ready yet... (attempt ${attempts}/${maxAttempts})`);\n              setTimeout(checkDimensions, 100);\n            }\n          };\n          checkDimensions();\n        });\n        if (canvasRef.current) {\n          canvasRef.current.width = videoRef.current.videoWidth;\n          canvasRef.current.height = videoRef.current.videoHeight;\n          console.log(`‚úÖ Canvas set to ${canvasRef.current.width}x${canvasRef.current.height}`);\n        }\n      }\n\n      // Initialize face detector\n      console.log('ü§ñ Initializing face detector...');\n      faceDetectorRef.current = new FaceDetector();\n      await faceDetectorRef.current.init();\n      console.log('‚úÖ Face detector initialized');\n\n      // Load baseline\n      console.log('üìä Loading baseline...');\n      faceDetectorRef.current.loadBaseline(baselineFace);\n      console.log('‚úÖ Baseline loaded');\n      setStatus('ready');\n      console.log('‚úÖ Test facial ready!');\n    } catch (err) {\n      console.error('‚ùå Failed to initialize test:', err);\n      setError(err.message || 'N√£o foi poss√≠vel iniciar o teste');\n      setStatus('error');\n    }\n  };\n  const handleStartTest = () => {\n    var _videoRef$current, _videoRef$current2;\n    console.log('handleStartTest called');\n    console.log('faceDetectorRef:', faceDetectorRef.current);\n    console.log('videoRef:', videoRef.current);\n    console.log('video dimensions:', (_videoRef$current = videoRef.current) === null || _videoRef$current === void 0 ? void 0 : _videoRef$current.videoWidth, (_videoRef$current2 = videoRef.current) === null || _videoRef$current2 === void 0 ? void 0 : _videoRef$current2.videoHeight);\n    if (!faceDetectorRef.current || !videoRef.current) {\n      console.error('Sistema n√£o inicializado');\n      setError('Sistema n√£o inicializado');\n      setStatus('error');\n      return;\n    }\n\n    // Validate video is ready\n    if (videoRef.current.videoWidth === 0 || videoRef.current.videoHeight === 0) {\n      console.error('V√≠deo n√£o est√° pronto');\n      setError('V√≠deo ainda n√£o est√° pronto. Aguarde um momento e tente novamente.');\n      setStatus('error');\n      return;\n    }\n    console.log('Starting test...');\n    setStatus('testing');\n    setTestDuration(0);\n    setCurrentStatus('Analisando...');\n\n    // Start timer (10 seconds test)\n    timerRef.current = setInterval(() => {\n      setTestDuration(prev => {\n        const newTime = prev + 0.1;\n        if (newTime >= 10) {\n          finishTest();\n        }\n        return newTime;\n      });\n    }, 100);\n\n    // Start detection loop\n    detectLoop();\n  };\n  const detectLoop = () => {\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const ctx = canvas === null || canvas === void 0 ? void 0 : canvas.getContext('2d');\n    const detector = faceDetectorRef.current;\n\n    // Stop if required resources are not available\n    if (!video || !canvas || !ctx || !detector) {\n      console.warn('Detection loop stopped: missing resources');\n      return;\n    }\n    try {\n      const timestamp = performance.now();\n      const result = detector.detectFrame(video, timestamp);\n\n      // Clear and draw\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n      if (result.faceDetected) {\n        // Draw landmarks\n        if (result.landmarks) {\n          drawLandmarks(ctx, result.landmarks, canvas.width, canvas.height, result.status === 'alert');\n        }\n\n        // Update status\n        if (result.status === 'alert') {\n          setCurrentStatus('‚ö†Ô∏è ASSIMETRIA DETECTADA!');\n          setDetectionResult(result);\n        } else if (result.status === 'ok') {\n          setCurrentStatus('‚úì Normal');\n        }\n      } else if (result.status === 'no_video') {\n        // Video not ready yet, wait a bit\n        setCurrentStatus('Aguardando v√≠deo...');\n      } else {\n        setCurrentStatus('Posicione seu rosto na c√¢mera');\n      }\n\n      // Continue loop\n      animationFrameRef.current = requestAnimationFrame(detectLoop);\n    } catch (err) {\n      console.error('Detection error:', err);\n      setError(err.message);\n      setStatus('error');\n    }\n  };\n  const finishTest = () => {\n    // Stop timer and animation\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current);\n      animationFrameRef.current = null;\n    }\n    setStatus('analyzing');\n\n    // Brief delay to show analyzing state\n    setTimeout(() => {\n      setStatus('result');\n    }, 1000);\n  };\n  const handleContinue = () => {\n    cleanup();\n    if (detectionResult && detectionResult.status === 'alert') {\n      // Skip to results attention\n      navigate('/results-attention');\n    } else {\n      // Continue to next test\n      navigate('/test-arm-right');\n    }\n  };\n  const handleRetry = () => {\n    if (faceDetectorRef.current) {\n      faceDetectorRef.current.reset();\n      if (baselineFace) {\n        faceDetectorRef.current.loadBaseline(baselineFace);\n      }\n    }\n    setStatus('ready');\n    setTestDuration(0);\n    setCurrentStatus('');\n    setDetectionResult(null);\n    setError(null);\n  };\n  const cleanup = () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n    }\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current);\n    }\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach(track => track.stop());\n    }\n    if (faceDetectorRef.current) {\n      faceDetectorRef.current.cleanup();\n    }\n  };\n\n  // Render states\n  if (status === 'init') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Inicializando teste facial...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 7\n    }, this);\n  }\n  if (status === 'error') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"icon danger\",\n        children: \"\\u26A0\\uFE0F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Erro\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-danger\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"button\",\n        onClick: initializeTest,\n        children: \"TENTAR NOVAMENTE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"button white mt-2\",\n        onClick: () => navigate('/dashboard'),\n        children: \"VOLTAR AO DASHBOARD\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 7\n    }, this);\n  }\n  if (status === 'result') {\n    var _detectionResult$skew, _detectionResult$base, _detectionResult$delt;\n    const hasAlert = detectionResult && detectionResult.status === 'alert';\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: `icon ${hasAlert ? 'danger' : 'success'}`,\n        children: hasAlert ? '‚ö†Ô∏è' : '‚úì'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Teste Facial \", hasAlert ? 'COM ALERTA' : 'OK']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `card mt-3 ${hasAlert ? 'alert danger' : 'alert success'}`,\n        children: hasAlert ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Assimetria Facial Detectada\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mt-2\",\n            children: \"O teste detectou uma assimetria significativa em sua express\\xE3o facial. Isso pode ser um sinal de alerta.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 15\n          }, this), detectionResult && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"\\xCDndice de assimetria:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 333,\n                columnNumber: 22\n              }, this), \" \", (_detectionResult$skew = detectionResult.skewScore) === null || _detectionResult$skew === void 0 ? void 0 : _detectionResult$skew.toFixed(4)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Baseline:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 334,\n                columnNumber: 22\n              }, this), \" \", (_detectionResult$base = detectionResult.baseline) === null || _detectionResult$base === void 0 ? void 0 : _detectionResult$base.toFixed(4)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 334,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Diferen\\xE7a:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 335,\n                columnNumber: 22\n              }, this), \" \", (_detectionResult$delt = detectionResult.delta) === null || _detectionResult$delt === void 0 ? void 0 : _detectionResult$delt.toFixed(4)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Teste Facial Normal\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mt-2\",\n            children: \"Nenhuma assimetria significativa foi detectada em sua express\\xE3o facial.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 9\n      }, this), hasAlert ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card mt-2 bg-info\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mb-0\",\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u26A0\\uFE0F Recomenda\\xE7\\xE3o:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 17\n            }, this), \" Devido ao resultado do teste, recomendamos que voc\\xEA acione a emerg\\xEAncia imediatamente.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 352,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button mt-3\",\n          onClick: () => navigate('/results-attention'),\n          children: \"ACIONAR EMERG\\xCANCIA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button white mt-2\",\n          onClick: handleRetry,\n          children: \"REFAZER TESTE\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button green mt-3\",\n          onClick: handleContinue,\n          children: \"CONTINUAR PARA PR\\xD3XIMO TESTE (2/4)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button white mt-2\",\n          onClick: handleRetry,\n          children: \"REFAZER TESTE\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 7\n    }, this);\n  }\n  if (status === 'analyzing') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Analisando Resultados...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-muted\",\n        children: \"Processando dados do teste facial\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Teste FAST 1/4 - Face (Rosto)\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-muted\",\n      children: \"Protocolo de Detec\\xE7\\xE3o de AVC\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 7\n    }, this), status === 'ready' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card mt-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Instru\\xE7\\xF5es\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"text-left\",\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Sorria\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 17\n          }, this), \" para a c\\xE2mera\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [\"Mantenha o sorriso por \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"10 segundos\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 398,\n            columnNumber: 40\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"O sistema ir\\xE1 detectar se h\\xE1 assimetria facial\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"Mantenha o rosto centralizado\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 400,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-muted mt-2\",\n        children: /*#__PURE__*/_jsxDEV(\"em\", {\n          children: \"Um sorriso assim\\xE9trico pode indicar fraqueza muscular facial\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-container mt-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"video\", {\n        ref: videoRef,\n        autoPlay: true,\n        playsInline: true,\n        muted: true,\n        style: {\n          display: status === 'testing' ? 'none' : 'block'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        style: {\n          display: status === 'testing' ? 'block' : 'none',\n          minHeight: '360px'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 416,\n        columnNumber: 9\n      }, this), status === 'init' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-overlay\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            top: '50%',\n            left: '50%',\n            transform: 'translate(-50%, -50%)',\n            background: 'rgba(0,0,0,0.8)',\n            padding: '20px 32px',\n            borderRadius: '12px',\n            color: 'white',\n            fontWeight: '600',\n            textAlign: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"spinner\",\n            style: {\n              margin: '0 auto 16px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 15\n          }, this), \"Carregando c\\xE2mera...\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 11\n      }, this), status === 'ready' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-overlay\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            bottom: '20px',\n            left: '50%',\n            transform: 'translateX(-50%)',\n            background: 'rgba(0,0,0,0.7)',\n            padding: '12px 24px',\n            borderRadius: '8px',\n            color: 'white',\n            fontWeight: '600',\n            textAlign: 'center'\n          },\n          children: \"\\uD83D\\uDCF9 C\\xE2mera ativa - Pronto para iniciar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 443,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 442,\n        columnNumber: 11\n      }, this), status === 'testing' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-overlay\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            top: '20px',\n            left: '50%',\n            transform: 'translateX(-50%)',\n            background: 'rgba(0,0,0,0.8)',\n            padding: '16px 32px',\n            borderRadius: '12px',\n            color: 'white',\n            fontWeight: '600',\n            fontSize: '1.2rem',\n            textAlign: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '2rem',\n              marginBottom: '8px'\n            },\n            children: [testDuration.toFixed(1), \"s\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 475,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: currentStatus\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 478,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 462,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 461,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 408,\n      columnNumber: 7\n    }, this), status === 'testing' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card mt-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"progress-bar\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"progress-fill\",\n          style: {\n            width: `${testDuration / 10 * 100}%`,\n            background: (detectionResult === null || detectionResult === void 0 ? void 0 : detectionResult.status) === 'alert' ? 'var(--primary-red)' : 'var(--primary-green)'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 487,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 486,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-center text-muted mt-2\",\n        children: [\"Mantenha o sorriso por \", (10 - testDuration).toFixed(1), \"s\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 497,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 485,\n      columnNumber: 9\n    }, this), status === 'ready' && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"button purple mt-3\",\n        onClick: handleStartTest,\n        children: \"\\uD83D\\uDE0A INICIAR TESTE FACIAL\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"button white mt-2\",\n        onClick: () => navigate('/dashboard'),\n        children: \"CANCELAR\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 508,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 389,\n    columnNumber: 5\n  }, this);\n}\n_s(TestFacial, \"ilJcyOODD6rh+KkfVoKe7U8yqBw=\", false, function () {\n  return [useNavigate, useApp];\n});\n_c = TestFacial;\nvar _c;\n$RefreshReg$(_c, \"TestFacial\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useNavigate","useApp","FaceDetector","drawLandmarks","jsxDEV","_jsxDEV","Fragment","_Fragment","TestFacial","_s","navigate","baselineFace","status","setStatus","testDuration","setTestDuration","detectionResult","setDetectionResult","currentStatus","setCurrentStatus","error","setError","streamVersion","setStreamVersion","videoRef","canvasRef","faceDetectorRef","streamRef","animationFrameRef","timerRef","initializeTest","cleanup","console","log","stream","navigator","mediaDevices","getUserMedia","video","facingMode","width","ideal","height","audio","current","srcObject","Promise","resolve","onloadedmetadata","play","playError","Error","reject","attempts","maxAttempts","checkDimensions","videoWidth","videoHeight","setTimeout","init","loadBaseline","err","message","handleStartTest","_videoRef$current","_videoRef$current2","setInterval","prev","newTime","finishTest","detectLoop","canvas","ctx","getContext","detector","warn","timestamp","performance","now","result","detectFrame","clearRect","drawImage","faceDetected","landmarks","requestAnimationFrame","clearInterval","cancelAnimationFrame","handleContinue","handleRetry","reset","getTracks","forEach","track","stop","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","_detectionResult$skew","_detectionResult$base","_detectionResult$delt","hasAlert","skewScore","toFixed","baseline","delta","ref","autoPlay","playsInline","muted","style","display","minHeight","position","top","left","transform","background","padding","borderRadius","color","fontWeight","textAlign","margin","bottom","fontSize","marginBottom","_c","$RefreshReg$"],"sources":["/home/hugorteixeira/AvisoVC/frontend/src/pages/TestFacial.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useApp } from '../contexts/AppContext';\nimport { FaceDetector, drawLandmarks } from '../utils/faceDetection';\n\nexport default function TestFacial() {\n  const navigate = useNavigate();\n  const { baselineFace } = useApp();\n\n  const [status, setStatus] = useState('init'); // init, ready, testing, analyzing, result, error\n  const [testDuration, setTestDuration] = useState(0);\n  const [detectionResult, setDetectionResult] = useState(null);\n  const [currentStatus, setCurrentStatus] = useState('');\n  const [error, setError] = useState(null);\n  const [streamVersion, setStreamVersion] = useState(0);\n\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const faceDetectorRef = useRef(null);\n  const streamRef = useRef(null);\n  const animationFrameRef = useRef(null);\n  const timerRef = useRef(null);\n\n  useEffect(() => {\n    initializeTest();\n    return () => {\n      cleanup();\n    };\n  }, []);\n\n  const initializeTest = async () => {\n    try {\n      console.log('üé¨ Initializing test facial...');\n\n      // Check if baseline exists\n      if (!baselineFace) {\n        console.error('‚ùå No baseline face found');\n        setError('Voc√™ precisa criar um perfil facial primeiro');\n        setStatus('error');\n        return;\n      }\n      console.log('‚úÖ Baseline exists:', baselineFace);\n\n      // Initialize camera\n      console.log('üìπ Requesting camera access...');\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'user',\n          width: { ideal: 720 },\n          height: { ideal: 540 },\n        },\n        audio: false,\n      });\n      console.log('‚úÖ Camera access granted');\n\n      streamRef.current = stream;\n\n      if (videoRef.current) {\n        console.log('üé• Setting up video element...');\n\n        // Clear any previous srcObject\n        if (videoRef.current.srcObject) {\n          console.log('‚ö†Ô∏è Clearing previous video source');\n          videoRef.current.srcObject = null;\n        }\n\n        videoRef.current.srcObject = stream;\n        await new Promise((resolve) => {\n          videoRef.current.onloadedmetadata = () => {\n            console.log('‚úÖ Video metadata loaded');\n            resolve();\n          };\n        });\n\n        // Ensure video is ready to play\n        try {\n          await videoRef.current.play();\n          console.log('‚úÖ Video playing');\n        } catch (playError) {\n          console.error('‚ùå Error playing video:', playError);\n          throw new Error('N√£o foi poss√≠vel reproduzir o v√≠deo da c√¢mera.');\n        }\n\n        // Wait for video to have valid dimensions\n        console.log('‚è≥ Waiting for video dimensions...');\n        await new Promise((resolve, reject) => {\n          let attempts = 0;\n          const maxAttempts = 50; // 5 seconds max\n          const checkDimensions = () => {\n            attempts++;\n            if (videoRef.current && videoRef.current.videoWidth > 0 && videoRef.current.videoHeight > 0) {\n              console.log(`‚úÖ Video dimensions: ${videoRef.current.videoWidth}x${videoRef.current.videoHeight}`);\n              resolve();\n            } else if (attempts >= maxAttempts) {\n              console.error(`‚ùå Timeout waiting for video dimensions after ${attempts} attempts`);\n              reject(new Error('Timeout esperando dimens√µes do v√≠deo. Tente recarregar a p√°gina.'));\n            } else {\n              console.log(`‚è≥ Video dimensions not ready yet... (attempt ${attempts}/${maxAttempts})`);\n              setTimeout(checkDimensions, 100);\n            }\n          };\n          checkDimensions();\n        });\n\n        if (canvasRef.current) {\n          canvasRef.current.width = videoRef.current.videoWidth;\n          canvasRef.current.height = videoRef.current.videoHeight;\n          console.log(`‚úÖ Canvas set to ${canvasRef.current.width}x${canvasRef.current.height}`);\n        }\n      }\n\n      // Initialize face detector\n      console.log('ü§ñ Initializing face detector...');\n      faceDetectorRef.current = new FaceDetector();\n      await faceDetectorRef.current.init();\n      console.log('‚úÖ Face detector initialized');\n\n      // Load baseline\n      console.log('üìä Loading baseline...');\n      faceDetectorRef.current.loadBaseline(baselineFace);\n      console.log('‚úÖ Baseline loaded');\n\n      setStatus('ready');\n      console.log('‚úÖ Test facial ready!');\n    } catch (err) {\n      console.error('‚ùå Failed to initialize test:', err);\n      setError(err.message || 'N√£o foi poss√≠vel iniciar o teste');\n      setStatus('error');\n    }\n  };\n\n  const handleStartTest = () => {\n    console.log('handleStartTest called');\n    console.log('faceDetectorRef:', faceDetectorRef.current);\n    console.log('videoRef:', videoRef.current);\n    console.log('video dimensions:', videoRef.current?.videoWidth, videoRef.current?.videoHeight);\n\n    if (!faceDetectorRef.current || !videoRef.current) {\n      console.error('Sistema n√£o inicializado');\n      setError('Sistema n√£o inicializado');\n      setStatus('error');\n      return;\n    }\n\n    // Validate video is ready\n    if (videoRef.current.videoWidth === 0 || videoRef.current.videoHeight === 0) {\n      console.error('V√≠deo n√£o est√° pronto');\n      setError('V√≠deo ainda n√£o est√° pronto. Aguarde um momento e tente novamente.');\n      setStatus('error');\n      return;\n    }\n\n    console.log('Starting test...');\n    setStatus('testing');\n    setTestDuration(0);\n    setCurrentStatus('Analisando...');\n\n    // Start timer (10 seconds test)\n    timerRef.current = setInterval(() => {\n      setTestDuration((prev) => {\n        const newTime = prev + 0.1;\n        if (newTime >= 10) {\n          finishTest();\n        }\n        return newTime;\n      });\n    }, 100);\n\n    // Start detection loop\n    detectLoop();\n  };\n\n  const detectLoop = () => {\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const ctx = canvas?.getContext('2d');\n    const detector = faceDetectorRef.current;\n\n    // Stop if required resources are not available\n    if (!video || !canvas || !ctx || !detector) {\n      console.warn('Detection loop stopped: missing resources');\n      return;\n    }\n\n    try {\n      const timestamp = performance.now();\n      const result = detector.detectFrame(video, timestamp);\n\n      // Clear and draw\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n      if (result.faceDetected) {\n        // Draw landmarks\n        if (result.landmarks) {\n          drawLandmarks(\n            ctx,\n            result.landmarks,\n            canvas.width,\n            canvas.height,\n            result.status === 'alert'\n          );\n        }\n\n        // Update status\n        if (result.status === 'alert') {\n          setCurrentStatus('‚ö†Ô∏è ASSIMETRIA DETECTADA!');\n          setDetectionResult(result);\n        } else if (result.status === 'ok') {\n          setCurrentStatus('‚úì Normal');\n        }\n      } else if (result.status === 'no_video') {\n        // Video not ready yet, wait a bit\n        setCurrentStatus('Aguardando v√≠deo...');\n      } else {\n        setCurrentStatus('Posicione seu rosto na c√¢mera');\n      }\n\n      // Continue loop\n      animationFrameRef.current = requestAnimationFrame(detectLoop);\n    } catch (err) {\n      console.error('Detection error:', err);\n      setError(err.message);\n      setStatus('error');\n    }\n  };\n\n  const finishTest = () => {\n    // Stop timer and animation\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current);\n      animationFrameRef.current = null;\n    }\n\n    setStatus('analyzing');\n\n    // Brief delay to show analyzing state\n    setTimeout(() => {\n      setStatus('result');\n    }, 1000);\n  };\n\n  const handleContinue = () => {\n    cleanup();\n    if (detectionResult && detectionResult.status === 'alert') {\n      // Skip to results attention\n      navigate('/results-attention');\n    } else {\n      // Continue to next test\n      navigate('/test-arm-right');\n    }\n  };\n\n  const handleRetry = () => {\n    if (faceDetectorRef.current) {\n      faceDetectorRef.current.reset();\n      if (baselineFace) {\n        faceDetectorRef.current.loadBaseline(baselineFace);\n      }\n    }\n    setStatus('ready');\n    setTestDuration(0);\n    setCurrentStatus('');\n    setDetectionResult(null);\n    setError(null);\n  };\n\n  const cleanup = () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n    }\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current);\n    }\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach((track) => track.stop());\n    }\n    if (faceDetectorRef.current) {\n      faceDetectorRef.current.cleanup();\n    }\n  };\n\n  // Render states\n  if (status === 'init') {\n    return (\n      <div className=\"container\">\n        <div className=\"spinner\"></div>\n        <p>Inicializando teste facial...</p>\n      </div>\n    );\n  }\n\n  if (status === 'error') {\n    return (\n      <div className=\"container\">\n        <div className=\"icon danger\">‚ö†Ô∏è</div>\n        <h1>Erro</h1>\n        <p className=\"text-danger\">{error}</p>\n        <button className=\"button\" onClick={initializeTest}>\n          TENTAR NOVAMENTE\n        </button>\n        <button className=\"button white mt-2\" onClick={() => navigate('/dashboard')}>\n          VOLTAR AO DASHBOARD\n        </button>\n      </div>\n    );\n  }\n\n  if (status === 'result') {\n    const hasAlert = detectionResult && detectionResult.status === 'alert';\n\n    return (\n      <div className=\"container\">\n        <div className={`icon ${hasAlert ? 'danger' : 'success'}`}>\n          {hasAlert ? '‚ö†Ô∏è' : '‚úì'}\n        </div>\n        <h1>Teste Facial {hasAlert ? 'COM ALERTA' : 'OK'}</h1>\n\n        <div className={`card mt-3 ${hasAlert ? 'alert danger' : 'alert success'}`}>\n          {hasAlert ? (\n            <>\n              <h3>Assimetria Facial Detectada</h3>\n              <p className=\"mt-2\">\n                O teste detectou uma assimetria significativa em sua express√£o facial.\n                Isso pode ser um sinal de alerta.\n              </p>\n              {detectionResult && (\n                <div className=\"mt-2\">\n                  <p><strong>√çndice de assimetria:</strong> {detectionResult.skewScore?.toFixed(4)}</p>\n                  <p><strong>Baseline:</strong> {detectionResult.baseline?.toFixed(4)}</p>\n                  <p><strong>Diferen√ßa:</strong> {detectionResult.delta?.toFixed(4)}</p>\n                </div>\n              )}\n            </>\n          ) : (\n            <>\n              <h3>Teste Facial Normal</h3>\n              <p className=\"mt-2\">\n                Nenhuma assimetria significativa foi detectada em sua express√£o facial.\n              </p>\n            </>\n          )}\n        </div>\n\n        {hasAlert ? (\n          <>\n            <div className=\"card mt-2 bg-info\">\n              <p className=\"mb-0\">\n                <strong>‚ö†Ô∏è Recomenda√ß√£o:</strong> Devido ao resultado do teste,\n                recomendamos que voc√™ acione a emerg√™ncia imediatamente.\n              </p>\n            </div>\n            <button className=\"button mt-3\" onClick={() => navigate('/results-attention')}>\n              ACIONAR EMERG√äNCIA\n            </button>\n            <button className=\"button white mt-2\" onClick={handleRetry}>\n              REFAZER TESTE\n            </button>\n          </>\n        ) : (\n          <>\n            <button className=\"button green mt-3\" onClick={handleContinue}>\n              CONTINUAR PARA PR√ìXIMO TESTE (2/4)\n            </button>\n            <button className=\"button white mt-2\" onClick={handleRetry}>\n              REFAZER TESTE\n            </button>\n          </>\n        )}\n      </div>\n    );\n  }\n\n  if (status === 'analyzing') {\n    return (\n      <div className=\"container\">\n        <div className=\"spinner\"></div>\n        <h1>Analisando Resultados...</h1>\n        <p className=\"text-muted\">Processando dados do teste facial</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container\">\n      <h1>Teste FAST 1/4 - Face (Rosto)</h1>\n      <p className=\"text-muted\">Protocolo de Detec√ß√£o de AVC</p>\n\n      {status === 'ready' && (\n        <div className=\"card mt-3\">\n          <h3>Instru√ß√µes</h3>\n          <ul className=\"text-left\">\n            <li><strong>Sorria</strong> para a c√¢mera</li>\n            <li>Mantenha o sorriso por <strong>10 segundos</strong></li>\n            <li>O sistema ir√° detectar se h√° assimetria facial</li>\n            <li>Mantenha o rosto centralizado</li>\n          </ul>\n          <p className=\"text-muted mt-2\">\n            <em>Um sorriso assim√©trico pode indicar fraqueza muscular facial</em>\n          </p>\n        </div>\n      )}\n\n      <div className=\"video-container mt-3\">\n        <video\n          ref={videoRef}\n          autoPlay\n          playsInline\n          muted\n          style={{ display: status === 'testing' ? 'none' : 'block' }}\n        />\n        <canvas\n          ref={canvasRef}\n          style={{ display: status === 'testing' ? 'block' : 'none', minHeight: '360px' }}\n        />\n\n        {status === 'init' && (\n          <div className=\"video-overlay\">\n            <div style={{\n              position: 'absolute',\n              top: '50%',\n              left: '50%',\n              transform: 'translate(-50%, -50%)',\n              background: 'rgba(0,0,0,0.8)',\n              padding: '20px 32px',\n              borderRadius: '12px',\n              color: 'white',\n              fontWeight: '600',\n              textAlign: 'center',\n            }}>\n              <div className=\"spinner\" style={{ margin: '0 auto 16px' }}></div>\n              Carregando c√¢mera...\n            </div>\n          </div>\n        )}\n\n        {status === 'ready' && (\n          <div className=\"video-overlay\">\n            <div style={{\n              position: 'absolute',\n              bottom: '20px',\n              left: '50%',\n              transform: 'translateX(-50%)',\n              background: 'rgba(0,0,0,0.7)',\n              padding: '12px 24px',\n              borderRadius: '8px',\n              color: 'white',\n              fontWeight: '600',\n              textAlign: 'center',\n            }}>\n              üìπ C√¢mera ativa - Pronto para iniciar\n            </div>\n          </div>\n        )}\n\n        {status === 'testing' && (\n          <div className=\"video-overlay\">\n            <div style={{\n              position: 'absolute',\n              top: '20px',\n              left: '50%',\n              transform: 'translateX(-50%)',\n              background: 'rgba(0,0,0,0.8)',\n              padding: '16px 32px',\n              borderRadius: '12px',\n              color: 'white',\n              fontWeight: '600',\n              fontSize: '1.2rem',\n              textAlign: 'center',\n            }}>\n              <div style={{ fontSize: '2rem', marginBottom: '8px' }}>\n                {testDuration.toFixed(1)}s\n              </div>\n              <div>{currentStatus}</div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {status === 'testing' && (\n        <div className=\"card mt-3\">\n          <div className=\"progress-bar\">\n            <div\n              className=\"progress-fill\"\n              style={{\n                width: `${(testDuration / 10) * 100}%`,\n                background: detectionResult?.status === 'alert'\n                  ? 'var(--primary-red)'\n                  : 'var(--primary-green)'\n              }}\n            ></div>\n          </div>\n          <p className=\"text-center text-muted mt-2\">\n            Mantenha o sorriso por {(10 - testDuration).toFixed(1)}s\n          </p>\n        </div>\n      )}\n\n      {status === 'ready' && (\n        <>\n          <button className=\"button purple mt-3\" onClick={handleStartTest}>\n            üòä INICIAR TESTE FACIAL\n          </button>\n          <button className=\"button white mt-2\" onClick={() => navigate('/dashboard')}>\n            CANCELAR\n          </button>\n        </>\n      )}\n    </div>\n  );\n}\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,MAAM,QAAQ,wBAAwB;AAC/C,SAASC,YAAY,EAAEC,aAAa,QAAQ,wBAAwB;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAErE,eAAe,SAASC,UAAUA,CAAA,EAAG;EAAAC,EAAA;EACnC,MAAMC,QAAQ,GAAGV,WAAW,CAAC,CAAC;EAC9B,MAAM;IAAEW;EAAa,CAAC,GAAGV,MAAM,CAAC,CAAC;EAEjC,MAAM,CAACW,MAAM,EAAEC,SAAS,CAAC,GAAGhB,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;EAC9C,MAAM,CAACiB,YAAY,EAAEC,eAAe,CAAC,GAAGlB,QAAQ,CAAC,CAAC,CAAC;EACnD,MAAM,CAACmB,eAAe,EAAEC,kBAAkB,CAAC,GAAGpB,QAAQ,CAAC,IAAI,CAAC;EAC5D,MAAM,CAACqB,aAAa,EAAEC,gBAAgB,CAAC,GAAGtB,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAACuB,KAAK,EAAEC,QAAQ,CAAC,GAAGxB,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACyB,aAAa,EAAEC,gBAAgB,CAAC,GAAG1B,QAAQ,CAAC,CAAC,CAAC;EAErD,MAAM2B,QAAQ,GAAGzB,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAM0B,SAAS,GAAG1B,MAAM,CAAC,IAAI,CAAC;EAC9B,MAAM2B,eAAe,GAAG3B,MAAM,CAAC,IAAI,CAAC;EACpC,MAAM4B,SAAS,GAAG5B,MAAM,CAAC,IAAI,CAAC;EAC9B,MAAM6B,iBAAiB,GAAG7B,MAAM,CAAC,IAAI,CAAC;EACtC,MAAM8B,QAAQ,GAAG9B,MAAM,CAAC,IAAI,CAAC;EAE7BD,SAAS,CAAC,MAAM;IACdgC,cAAc,CAAC,CAAC;IAChB,OAAO,MAAM;MACXC,OAAO,CAAC,CAAC;IACX,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMD,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjC,IAAI;MACFE,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;;MAE7C;MACA,IAAI,CAACtB,YAAY,EAAE;QACjBqB,OAAO,CAACZ,KAAK,CAAC,0BAA0B,CAAC;QACzCC,QAAQ,CAAC,8CAA8C,CAAC;QACxDR,SAAS,CAAC,OAAO,CAAC;QAClB;MACF;MACAmB,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEtB,YAAY,CAAC;;MAE/C;MACAqB,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;MAC7C,MAAMC,MAAM,GAAG,MAAMC,SAAS,CAACC,YAAY,CAACC,YAAY,CAAC;QACvDC,KAAK,EAAE;UACLC,UAAU,EAAE,MAAM;UAClBC,KAAK,EAAE;YAAEC,KAAK,EAAE;UAAI,CAAC;UACrBC,MAAM,EAAE;YAAED,KAAK,EAAE;UAAI;QACvB,CAAC;QACDE,KAAK,EAAE;MACT,CAAC,CAAC;MACFX,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAC;MAEtCN,SAAS,CAACiB,OAAO,GAAGV,MAAM;MAE1B,IAAIV,QAAQ,CAACoB,OAAO,EAAE;QACpBZ,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;;QAE7C;QACA,IAAIT,QAAQ,CAACoB,OAAO,CAACC,SAAS,EAAE;UAC9Bb,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;UAChDT,QAAQ,CAACoB,OAAO,CAACC,SAAS,GAAG,IAAI;QACnC;QAEArB,QAAQ,CAACoB,OAAO,CAACC,SAAS,GAAGX,MAAM;QACnC,MAAM,IAAIY,OAAO,CAAEC,OAAO,IAAK;UAC7BvB,QAAQ,CAACoB,OAAO,CAACI,gBAAgB,GAAG,MAAM;YACxChB,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAC;YACtCc,OAAO,CAAC,CAAC;UACX,CAAC;QACH,CAAC,CAAC;;QAEF;QACA,IAAI;UACF,MAAMvB,QAAQ,CAACoB,OAAO,CAACK,IAAI,CAAC,CAAC;UAC7BjB,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC;QAChC,CAAC,CAAC,OAAOiB,SAAS,EAAE;UAClBlB,OAAO,CAACZ,KAAK,CAAC,wBAAwB,EAAE8B,SAAS,CAAC;UAClD,MAAM,IAAIC,KAAK,CAAC,gDAAgD,CAAC;QACnE;;QAEA;QACAnB,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;QAChD,MAAM,IAAIa,OAAO,CAAC,CAACC,OAAO,EAAEK,MAAM,KAAK;UACrC,IAAIC,QAAQ,GAAG,CAAC;UAChB,MAAMC,WAAW,GAAG,EAAE,CAAC,CAAC;UACxB,MAAMC,eAAe,GAAGA,CAAA,KAAM;YAC5BF,QAAQ,EAAE;YACV,IAAI7B,QAAQ,CAACoB,OAAO,IAAIpB,QAAQ,CAACoB,OAAO,CAACY,UAAU,GAAG,CAAC,IAAIhC,QAAQ,CAACoB,OAAO,CAACa,WAAW,GAAG,CAAC,EAAE;cAC3FzB,OAAO,CAACC,GAAG,CAAC,uBAAuBT,QAAQ,CAACoB,OAAO,CAACY,UAAU,IAAIhC,QAAQ,CAACoB,OAAO,CAACa,WAAW,EAAE,CAAC;cACjGV,OAAO,CAAC,CAAC;YACX,CAAC,MAAM,IAAIM,QAAQ,IAAIC,WAAW,EAAE;cAClCtB,OAAO,CAACZ,KAAK,CAAC,gDAAgDiC,QAAQ,WAAW,CAAC;cAClFD,MAAM,CAAC,IAAID,KAAK,CAAC,kEAAkE,CAAC,CAAC;YACvF,CAAC,MAAM;cACLnB,OAAO,CAACC,GAAG,CAAC,gDAAgDoB,QAAQ,IAAIC,WAAW,GAAG,CAAC;cACvFI,UAAU,CAACH,eAAe,EAAE,GAAG,CAAC;YAClC;UACF,CAAC;UACDA,eAAe,CAAC,CAAC;QACnB,CAAC,CAAC;QAEF,IAAI9B,SAAS,CAACmB,OAAO,EAAE;UACrBnB,SAAS,CAACmB,OAAO,CAACJ,KAAK,GAAGhB,QAAQ,CAACoB,OAAO,CAACY,UAAU;UACrD/B,SAAS,CAACmB,OAAO,CAACF,MAAM,GAAGlB,QAAQ,CAACoB,OAAO,CAACa,WAAW;UACvDzB,OAAO,CAACC,GAAG,CAAC,mBAAmBR,SAAS,CAACmB,OAAO,CAACJ,KAAK,IAAIf,SAAS,CAACmB,OAAO,CAACF,MAAM,EAAE,CAAC;QACvF;MACF;;MAEA;MACAV,OAAO,CAACC,GAAG,CAAC,kCAAkC,CAAC;MAC/CP,eAAe,CAACkB,OAAO,GAAG,IAAI1C,YAAY,CAAC,CAAC;MAC5C,MAAMwB,eAAe,CAACkB,OAAO,CAACe,IAAI,CAAC,CAAC;MACpC3B,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC;;MAE1C;MACAD,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;MACrCP,eAAe,CAACkB,OAAO,CAACgB,YAAY,CAACjD,YAAY,CAAC;MAClDqB,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;MAEhCpB,SAAS,CAAC,OAAO,CAAC;MAClBmB,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;IACrC,CAAC,CAAC,OAAO4B,GAAG,EAAE;MACZ7B,OAAO,CAACZ,KAAK,CAAC,8BAA8B,EAAEyC,GAAG,CAAC;MAClDxC,QAAQ,CAACwC,GAAG,CAACC,OAAO,IAAI,kCAAkC,CAAC;MAC3DjD,SAAS,CAAC,OAAO,CAAC;IACpB;EACF,CAAC;EAED,MAAMkD,eAAe,GAAGA,CAAA,KAAM;IAAA,IAAAC,iBAAA,EAAAC,kBAAA;IAC5BjC,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;IACrCD,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEP,eAAe,CAACkB,OAAO,CAAC;IACxDZ,OAAO,CAACC,GAAG,CAAC,WAAW,EAAET,QAAQ,CAACoB,OAAO,CAAC;IAC1CZ,OAAO,CAACC,GAAG,CAAC,mBAAmB,GAAA+B,iBAAA,GAAExC,QAAQ,CAACoB,OAAO,cAAAoB,iBAAA,uBAAhBA,iBAAA,CAAkBR,UAAU,GAAAS,kBAAA,GAAEzC,QAAQ,CAACoB,OAAO,cAAAqB,kBAAA,uBAAhBA,kBAAA,CAAkBR,WAAW,CAAC;IAE7F,IAAI,CAAC/B,eAAe,CAACkB,OAAO,IAAI,CAACpB,QAAQ,CAACoB,OAAO,EAAE;MACjDZ,OAAO,CAACZ,KAAK,CAAC,0BAA0B,CAAC;MACzCC,QAAQ,CAAC,0BAA0B,CAAC;MACpCR,SAAS,CAAC,OAAO,CAAC;MAClB;IACF;;IAEA;IACA,IAAIW,QAAQ,CAACoB,OAAO,CAACY,UAAU,KAAK,CAAC,IAAIhC,QAAQ,CAACoB,OAAO,CAACa,WAAW,KAAK,CAAC,EAAE;MAC3EzB,OAAO,CAACZ,KAAK,CAAC,uBAAuB,CAAC;MACtCC,QAAQ,CAAC,oEAAoE,CAAC;MAC9ER,SAAS,CAAC,OAAO,CAAC;MAClB;IACF;IAEAmB,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC;IAC/BpB,SAAS,CAAC,SAAS,CAAC;IACpBE,eAAe,CAAC,CAAC,CAAC;IAClBI,gBAAgB,CAAC,eAAe,CAAC;;IAEjC;IACAU,QAAQ,CAACe,OAAO,GAAGsB,WAAW,CAAC,MAAM;MACnCnD,eAAe,CAAEoD,IAAI,IAAK;QACxB,MAAMC,OAAO,GAAGD,IAAI,GAAG,GAAG;QAC1B,IAAIC,OAAO,IAAI,EAAE,EAAE;UACjBC,UAAU,CAAC,CAAC;QACd;QACA,OAAOD,OAAO;MAChB,CAAC,CAAC;IACJ,CAAC,EAAE,GAAG,CAAC;;IAEP;IACAE,UAAU,CAAC,CAAC;EACd,CAAC;EAED,MAAMA,UAAU,GAAGA,CAAA,KAAM;IACvB,MAAMhC,KAAK,GAAGd,QAAQ,CAACoB,OAAO;IAC9B,MAAM2B,MAAM,GAAG9C,SAAS,CAACmB,OAAO;IAChC,MAAM4B,GAAG,GAAGD,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEE,UAAU,CAAC,IAAI,CAAC;IACpC,MAAMC,QAAQ,GAAGhD,eAAe,CAACkB,OAAO;;IAExC;IACA,IAAI,CAACN,KAAK,IAAI,CAACiC,MAAM,IAAI,CAACC,GAAG,IAAI,CAACE,QAAQ,EAAE;MAC1C1C,OAAO,CAAC2C,IAAI,CAAC,2CAA2C,CAAC;MACzD;IACF;IAEA,IAAI;MACF,MAAMC,SAAS,GAAGC,WAAW,CAACC,GAAG,CAAC,CAAC;MACnC,MAAMC,MAAM,GAAGL,QAAQ,CAACM,WAAW,CAAC1C,KAAK,EAAEsC,SAAS,CAAC;;MAErD;MACAJ,GAAG,CAACS,SAAS,CAAC,CAAC,EAAE,CAAC,EAAEV,MAAM,CAAC/B,KAAK,EAAE+B,MAAM,CAAC7B,MAAM,CAAC;MAChD8B,GAAG,CAACU,SAAS,CAAC5C,KAAK,EAAE,CAAC,EAAE,CAAC,EAAEiC,MAAM,CAAC/B,KAAK,EAAE+B,MAAM,CAAC7B,MAAM,CAAC;MAEvD,IAAIqC,MAAM,CAACI,YAAY,EAAE;QACvB;QACA,IAAIJ,MAAM,CAACK,SAAS,EAAE;UACpBjF,aAAa,CACXqE,GAAG,EACHO,MAAM,CAACK,SAAS,EAChBb,MAAM,CAAC/B,KAAK,EACZ+B,MAAM,CAAC7B,MAAM,EACbqC,MAAM,CAACnE,MAAM,KAAK,OACpB,CAAC;QACH;;QAEA;QACA,IAAImE,MAAM,CAACnE,MAAM,KAAK,OAAO,EAAE;UAC7BO,gBAAgB,CAAC,0BAA0B,CAAC;UAC5CF,kBAAkB,CAAC8D,MAAM,CAAC;QAC5B,CAAC,MAAM,IAAIA,MAAM,CAACnE,MAAM,KAAK,IAAI,EAAE;UACjCO,gBAAgB,CAAC,UAAU,CAAC;QAC9B;MACF,CAAC,MAAM,IAAI4D,MAAM,CAACnE,MAAM,KAAK,UAAU,EAAE;QACvC;QACAO,gBAAgB,CAAC,qBAAqB,CAAC;MACzC,CAAC,MAAM;QACLA,gBAAgB,CAAC,+BAA+B,CAAC;MACnD;;MAEA;MACAS,iBAAiB,CAACgB,OAAO,GAAGyC,qBAAqB,CAACf,UAAU,CAAC;IAC/D,CAAC,CAAC,OAAOT,GAAG,EAAE;MACZ7B,OAAO,CAACZ,KAAK,CAAC,kBAAkB,EAAEyC,GAAG,CAAC;MACtCxC,QAAQ,CAACwC,GAAG,CAACC,OAAO,CAAC;MACrBjD,SAAS,CAAC,OAAO,CAAC;IACpB;EACF,CAAC;EAED,MAAMwD,UAAU,GAAGA,CAAA,KAAM;IACvB;IACA,IAAIxC,QAAQ,CAACe,OAAO,EAAE;MACpB0C,aAAa,CAACzD,QAAQ,CAACe,OAAO,CAAC;MAC/Bf,QAAQ,CAACe,OAAO,GAAG,IAAI;IACzB;IACA,IAAIhB,iBAAiB,CAACgB,OAAO,EAAE;MAC7B2C,oBAAoB,CAAC3D,iBAAiB,CAACgB,OAAO,CAAC;MAC/ChB,iBAAiB,CAACgB,OAAO,GAAG,IAAI;IAClC;IAEA/B,SAAS,CAAC,WAAW,CAAC;;IAEtB;IACA6C,UAAU,CAAC,MAAM;MACf7C,SAAS,CAAC,QAAQ,CAAC;IACrB,CAAC,EAAE,IAAI,CAAC;EACV,CAAC;EAED,MAAM2E,cAAc,GAAGA,CAAA,KAAM;IAC3BzD,OAAO,CAAC,CAAC;IACT,IAAIf,eAAe,IAAIA,eAAe,CAACJ,MAAM,KAAK,OAAO,EAAE;MACzD;MACAF,QAAQ,CAAC,oBAAoB,CAAC;IAChC,CAAC,MAAM;MACL;MACAA,QAAQ,CAAC,iBAAiB,CAAC;IAC7B;EACF,CAAC;EAED,MAAM+E,WAAW,GAAGA,CAAA,KAAM;IACxB,IAAI/D,eAAe,CAACkB,OAAO,EAAE;MAC3BlB,eAAe,CAACkB,OAAO,CAAC8C,KAAK,CAAC,CAAC;MAC/B,IAAI/E,YAAY,EAAE;QAChBe,eAAe,CAACkB,OAAO,CAACgB,YAAY,CAACjD,YAAY,CAAC;MACpD;IACF;IACAE,SAAS,CAAC,OAAO,CAAC;IAClBE,eAAe,CAAC,CAAC,CAAC;IAClBI,gBAAgB,CAAC,EAAE,CAAC;IACpBF,kBAAkB,CAAC,IAAI,CAAC;IACxBI,QAAQ,CAAC,IAAI,CAAC;EAChB,CAAC;EAED,MAAMU,OAAO,GAAGA,CAAA,KAAM;IACpB,IAAIF,QAAQ,CAACe,OAAO,EAAE;MACpB0C,aAAa,CAACzD,QAAQ,CAACe,OAAO,CAAC;IACjC;IACA,IAAIhB,iBAAiB,CAACgB,OAAO,EAAE;MAC7B2C,oBAAoB,CAAC3D,iBAAiB,CAACgB,OAAO,CAAC;IACjD;IACA,IAAIjB,SAAS,CAACiB,OAAO,EAAE;MACrBjB,SAAS,CAACiB,OAAO,CAAC+C,SAAS,CAAC,CAAC,CAACC,OAAO,CAAEC,KAAK,IAAKA,KAAK,CAACC,IAAI,CAAC,CAAC,CAAC;IAChE;IACA,IAAIpE,eAAe,CAACkB,OAAO,EAAE;MAC3BlB,eAAe,CAACkB,OAAO,CAACb,OAAO,CAAC,CAAC;IACnC;EACF,CAAC;;EAED;EACA,IAAInB,MAAM,KAAK,MAAM,EAAE;IACrB,oBACEP,OAAA;MAAK0F,SAAS,EAAC,WAAW;MAAAC,QAAA,gBACxB3F,OAAA;QAAK0F,SAAS,EAAC;MAAS;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eAC/B/F,OAAA;QAAA2F,QAAA,EAAG;MAA6B;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACjC,CAAC;EAEV;EAEA,IAAIxF,MAAM,KAAK,OAAO,EAAE;IACtB,oBACEP,OAAA;MAAK0F,SAAS,EAAC,WAAW;MAAAC,QAAA,gBACxB3F,OAAA;QAAK0F,SAAS,EAAC,aAAa;QAAAC,QAAA,EAAC;MAAE;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACrC/F,OAAA;QAAA2F,QAAA,EAAI;MAAI;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACb/F,OAAA;QAAG0F,SAAS,EAAC,aAAa;QAAAC,QAAA,EAAE5E;MAAK;QAAA6E,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACtC/F,OAAA;QAAQ0F,SAAS,EAAC,QAAQ;QAACM,OAAO,EAAEvE,cAAe;QAAAkE,QAAA,EAAC;MAEpD;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACT/F,OAAA;QAAQ0F,SAAS,EAAC,mBAAmB;QAACM,OAAO,EAAEA,CAAA,KAAM3F,QAAQ,CAAC,YAAY,CAAE;QAAAsF,QAAA,EAAC;MAE7E;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC;EAEV;EAEA,IAAIxF,MAAM,KAAK,QAAQ,EAAE;IAAA,IAAA0F,qBAAA,EAAAC,qBAAA,EAAAC,qBAAA;IACvB,MAAMC,QAAQ,GAAGzF,eAAe,IAAIA,eAAe,CAACJ,MAAM,KAAK,OAAO;IAEtE,oBACEP,OAAA;MAAK0F,SAAS,EAAC,WAAW;MAAAC,QAAA,gBACxB3F,OAAA;QAAK0F,SAAS,EAAE,QAAQU,QAAQ,GAAG,QAAQ,GAAG,SAAS,EAAG;QAAAT,QAAA,EACvDS,QAAQ,GAAG,IAAI,GAAG;MAAG;QAAAR,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACnB,CAAC,eACN/F,OAAA;QAAA2F,QAAA,GAAI,eAAa,EAACS,QAAQ,GAAG,YAAY,GAAG,IAAI;MAAA;QAAAR,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eAEtD/F,OAAA;QAAK0F,SAAS,EAAE,aAAaU,QAAQ,GAAG,cAAc,GAAG,eAAe,EAAG;QAAAT,QAAA,EACxES,QAAQ,gBACPpG,OAAA,CAAAE,SAAA;UAAAyF,QAAA,gBACE3F,OAAA;YAAA2F,QAAA,EAAI;UAA2B;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACpC/F,OAAA;YAAG0F,SAAS,EAAC,MAAM;YAAAC,QAAA,EAAC;UAGpB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,EACHpF,eAAe,iBACdX,OAAA;YAAK0F,SAAS,EAAC,MAAM;YAAAC,QAAA,gBACnB3F,OAAA;cAAA2F,QAAA,gBAAG3F,OAAA;gBAAA2F,QAAA,EAAQ;cAAqB;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,GAAAE,qBAAA,GAACtF,eAAe,CAAC0F,SAAS,cAAAJ,qBAAA,uBAAzBA,qBAAA,CAA2BK,OAAO,CAAC,CAAC,CAAC;YAAA;cAAAV,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACrF/F,OAAA;cAAA2F,QAAA,gBAAG3F,OAAA;gBAAA2F,QAAA,EAAQ;cAAS;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,GAAAG,qBAAA,GAACvF,eAAe,CAAC4F,QAAQ,cAAAL,qBAAA,uBAAxBA,qBAAA,CAA0BI,OAAO,CAAC,CAAC,CAAC;YAAA;cAAAV,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eACxE/F,OAAA;cAAA2F,QAAA,gBAAG3F,OAAA;gBAAA2F,QAAA,EAAQ;cAAU;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,KAAC,GAAAI,qBAAA,GAACxF,eAAe,CAAC6F,KAAK,cAAAL,qBAAA,uBAArBA,qBAAA,CAAuBG,OAAO,CAAC,CAAC,CAAC;YAAA;cAAAV,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnE,CACN;QAAA,eACD,CAAC,gBAEH/F,OAAA,CAAAE,SAAA;UAAAyF,QAAA,gBACE3F,OAAA;YAAA2F,QAAA,EAAI;UAAmB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC5B/F,OAAA;YAAG0F,SAAS,EAAC,MAAM;YAAAC,QAAA,EAAC;UAEpB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC;QAAA,eACJ;MACH;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC,EAELK,QAAQ,gBACPpG,OAAA,CAAAE,SAAA;QAAAyF,QAAA,gBACE3F,OAAA;UAAK0F,SAAS,EAAC,mBAAmB;UAAAC,QAAA,eAChC3F,OAAA;YAAG0F,SAAS,EAAC,MAAM;YAAAC,QAAA,gBACjB3F,OAAA;cAAA2F,QAAA,EAAQ;YAAgB;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,iGAEnC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACD,CAAC,eACN/F,OAAA;UAAQ0F,SAAS,EAAC,aAAa;UAACM,OAAO,EAAEA,CAAA,KAAM3F,QAAQ,CAAC,oBAAoB,CAAE;UAAAsF,QAAA,EAAC;QAE/E;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACT/F,OAAA;UAAQ0F,SAAS,EAAC,mBAAmB;UAACM,OAAO,EAAEZ,WAAY;UAAAO,QAAA,EAAC;QAE5D;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA,eACT,CAAC,gBAEH/F,OAAA,CAAAE,SAAA;QAAAyF,QAAA,gBACE3F,OAAA;UAAQ0F,SAAS,EAAC,mBAAmB;UAACM,OAAO,EAAEb,cAAe;UAAAQ,QAAA,EAAC;QAE/D;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACT/F,OAAA;UAAQ0F,SAAS,EAAC,mBAAmB;UAACM,OAAO,EAAEZ,WAAY;UAAAO,QAAA,EAAC;QAE5D;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA,eACT,CACH;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC;EAEV;EAEA,IAAIxF,MAAM,KAAK,WAAW,EAAE;IAC1B,oBACEP,OAAA;MAAK0F,SAAS,EAAC,WAAW;MAAAC,QAAA,gBACxB3F,OAAA;QAAK0F,SAAS,EAAC;MAAS;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eAC/B/F,OAAA;QAAA2F,QAAA,EAAI;MAAwB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACjC/F,OAAA;QAAG0F,SAAS,EAAC,YAAY;QAAAC,QAAA,EAAC;MAAiC;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC5D,CAAC;EAEV;EAEA,oBACE/F,OAAA;IAAK0F,SAAS,EAAC,WAAW;IAAAC,QAAA,gBACxB3F,OAAA;MAAA2F,QAAA,EAAI;IAA6B;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eACtC/F,OAAA;MAAG0F,SAAS,EAAC,YAAY;MAAAC,QAAA,EAAC;IAA4B;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC,EAEzDxF,MAAM,KAAK,OAAO,iBACjBP,OAAA;MAAK0F,SAAS,EAAC,WAAW;MAAAC,QAAA,gBACxB3F,OAAA;QAAA2F,QAAA,EAAI;MAAU;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACnB/F,OAAA;QAAI0F,SAAS,EAAC,WAAW;QAAAC,QAAA,gBACvB3F,OAAA;UAAA2F,QAAA,gBAAI3F,OAAA;YAAA2F,QAAA,EAAQ;UAAM;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,qBAAc;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC9C/F,OAAA;UAAA2F,QAAA,GAAI,yBAAuB,eAAA3F,OAAA;YAAA2F,QAAA,EAAQ;UAAW;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC5D/F,OAAA;UAAA2F,QAAA,EAAI;QAA8C;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACvD/F,OAAA;UAAA2F,QAAA,EAAI;QAA6B;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpC,CAAC,eACL/F,OAAA;QAAG0F,SAAS,EAAC,iBAAiB;QAAAC,QAAA,eAC5B3F,OAAA;UAAA2F,QAAA,EAAI;QAA4D;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACD,CACN,eAED/F,OAAA;MAAK0F,SAAS,EAAC,sBAAsB;MAAAC,QAAA,gBACnC3F,OAAA;QACEyG,GAAG,EAAEtF,QAAS;QACduF,QAAQ;QACRC,WAAW;QACXC,KAAK;QACLC,KAAK,EAAE;UAAEC,OAAO,EAAEvG,MAAM,KAAK,SAAS,GAAG,MAAM,GAAG;QAAQ;MAAE;QAAAqF,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC7D,CAAC,eACF/F,OAAA;QACEyG,GAAG,EAAErF,SAAU;QACfyF,KAAK,EAAE;UAAEC,OAAO,EAAEvG,MAAM,KAAK,SAAS,GAAG,OAAO,GAAG,MAAM;UAAEwG,SAAS,EAAE;QAAQ;MAAE;QAAAnB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACjF,CAAC,EAEDxF,MAAM,KAAK,MAAM,iBAChBP,OAAA;QAAK0F,SAAS,EAAC,eAAe;QAAAC,QAAA,eAC5B3F,OAAA;UAAK6G,KAAK,EAAE;YACVG,QAAQ,EAAE,UAAU;YACpBC,GAAG,EAAE,KAAK;YACVC,IAAI,EAAE,KAAK;YACXC,SAAS,EAAE,uBAAuB;YAClCC,UAAU,EAAE,iBAAiB;YAC7BC,OAAO,EAAE,WAAW;YACpBC,YAAY,EAAE,MAAM;YACpBC,KAAK,EAAE,OAAO;YACdC,UAAU,EAAE,KAAK;YACjBC,SAAS,EAAE;UACb,CAAE;UAAA9B,QAAA,gBACA3F,OAAA;YAAK0F,SAAS,EAAC,SAAS;YAACmB,KAAK,EAAE;cAAEa,MAAM,EAAE;YAAc;UAAE;YAAA9B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,2BAEnE;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CACN,EAEAxF,MAAM,KAAK,OAAO,iBACjBP,OAAA;QAAK0F,SAAS,EAAC,eAAe;QAAAC,QAAA,eAC5B3F,OAAA;UAAK6G,KAAK,EAAE;YACVG,QAAQ,EAAE,UAAU;YACpBW,MAAM,EAAE,MAAM;YACdT,IAAI,EAAE,KAAK;YACXC,SAAS,EAAE,kBAAkB;YAC7BC,UAAU,EAAE,iBAAiB;YAC7BC,OAAO,EAAE,WAAW;YACpBC,YAAY,EAAE,KAAK;YACnBC,KAAK,EAAE,OAAO;YACdC,UAAU,EAAE,KAAK;YACjBC,SAAS,EAAE;UACb,CAAE;UAAA9B,QAAA,EAAC;QAEH;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CACN,EAEAxF,MAAM,KAAK,SAAS,iBACnBP,OAAA;QAAK0F,SAAS,EAAC,eAAe;QAAAC,QAAA,eAC5B3F,OAAA;UAAK6G,KAAK,EAAE;YACVG,QAAQ,EAAE,UAAU;YACpBC,GAAG,EAAE,MAAM;YACXC,IAAI,EAAE,KAAK;YACXC,SAAS,EAAE,kBAAkB;YAC7BC,UAAU,EAAE,iBAAiB;YAC7BC,OAAO,EAAE,WAAW;YACpBC,YAAY,EAAE,MAAM;YACpBC,KAAK,EAAE,OAAO;YACdC,UAAU,EAAE,KAAK;YACjBI,QAAQ,EAAE,QAAQ;YAClBH,SAAS,EAAE;UACb,CAAE;UAAA9B,QAAA,gBACA3F,OAAA;YAAK6G,KAAK,EAAE;cAAEe,QAAQ,EAAE,MAAM;cAAEC,YAAY,EAAE;YAAM,CAAE;YAAAlC,QAAA,GACnDlF,YAAY,CAAC6F,OAAO,CAAC,CAAC,CAAC,EAAC,GAC3B;UAAA;YAAAV,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACN/F,OAAA;YAAA2F,QAAA,EAAM9E;UAAa;YAAA+E,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvB;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,EAELxF,MAAM,KAAK,SAAS,iBACnBP,OAAA;MAAK0F,SAAS,EAAC,WAAW;MAAAC,QAAA,gBACxB3F,OAAA;QAAK0F,SAAS,EAAC,cAAc;QAAAC,QAAA,eAC3B3F,OAAA;UACE0F,SAAS,EAAC,eAAe;UACzBmB,KAAK,EAAE;YACL1E,KAAK,EAAE,GAAI1B,YAAY,GAAG,EAAE,GAAI,GAAG,GAAG;YACtC2G,UAAU,EAAE,CAAAzG,eAAe,aAAfA,eAAe,uBAAfA,eAAe,CAAEJ,MAAM,MAAK,OAAO,GAC3C,oBAAoB,GACpB;UACN;QAAE;UAAAqF,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACJ,CAAC,eACN/F,OAAA;QAAG0F,SAAS,EAAC,6BAA6B;QAAAC,QAAA,GAAC,yBAClB,EAAC,CAAC,EAAE,GAAGlF,YAAY,EAAE6F,OAAO,CAAC,CAAC,CAAC,EAAC,GACzD;MAAA;QAAAV,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACD,CACN,EAEAxF,MAAM,KAAK,OAAO,iBACjBP,OAAA,CAAAE,SAAA;MAAAyF,QAAA,gBACE3F,OAAA;QAAQ0F,SAAS,EAAC,oBAAoB;QAACM,OAAO,EAAEtC,eAAgB;QAAAiC,QAAA,EAAC;MAEjE;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC,eACT/F,OAAA;QAAQ0F,SAAS,EAAC,mBAAmB;QAACM,OAAO,EAAEA,CAAA,KAAM3F,QAAQ,CAAC,YAAY,CAAE;QAAAsF,QAAA,EAAC;MAE7E;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA,eACT,CACH;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV;AAAC3F,EAAA,CA7fuBD,UAAU;EAAA,QACfR,WAAW,EACHC,MAAM;AAAA;AAAAkI,EAAA,GAFT3H,UAAU;AAAA,IAAA2H,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}