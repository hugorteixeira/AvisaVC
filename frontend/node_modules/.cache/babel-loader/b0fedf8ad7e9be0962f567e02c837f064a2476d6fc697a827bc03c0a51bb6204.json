{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{useNavigate}from'react-router-dom';import{useApp}from'../contexts/AppContext';import{FaceDetector,drawLandmarks}from'../utils/faceDetection';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function FaceRecording(){const navigate=useNavigate();const{setBaselineFace}=useApp();const[status,setStatus]=useState('init');// init, ready, calibrating, complete, error\nconst[progress,setProgress]=useState(0);const[message,setMessage]=useState('Inicializando c√¢mera...');const[error,setError]=useState(null);const[baselineData,setBaselineData]=useState(null);const videoRef=useRef(null);const canvasRef=useRef(null);const faceDetectorRef=useRef(null);const streamRef=useRef(null);const animationFrameRef=useRef(null);useEffect(()=>{initializeCamera();return()=>{cleanup();};},[]);const initializeCamera=async()=>{try{// Request camera access\nconst stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:'user',width:{ideal:720},height:{ideal:540}},audio:false});streamRef.current=stream;// Set video source\nif(videoRef.current){videoRef.current.srcObject=stream;await new Promise(resolve=>{videoRef.current.onloadedmetadata=resolve;});await videoRef.current.play();// Set canvas size\nif(canvasRef.current){canvasRef.current.width=videoRef.current.videoWidth;canvasRef.current.height=videoRef.current.videoHeight;}}// Initialize face detector\nsetMessage('Carregando detector facial...');faceDetectorRef.current=new FaceDetector();await faceDetectorRef.current.init();setStatus('ready');setMessage('Pronto para iniciar');}catch(err){console.error('Failed to initialize:',err);setError(err.message||'N√£o foi poss√≠vel acessar a c√¢mera');setStatus('error');}};const handleStartCalibration=()=>{if(!faceDetectorRef.current||!videoRef.current){setError('Sistema n√£o inicializado');return;}setStatus('calibrating');setProgress(0);setMessage('Calibrando... Mantenha o rosto centralizado');// Start detection loop\ndetectLoop();};const detectLoop=()=>{if(status==='complete'||status==='error')return;const video=videoRef.current;const canvas=canvasRef.current;const ctx=canvas===null||canvas===void 0?void 0:canvas.getContext('2d');const detector=faceDetectorRef.current;if(!video||!canvas||!ctx||!detector)return;try{const timestamp=performance.now();const result=detector.detectFrame(video,timestamp);// Clear canvas and draw video\nctx.clearRect(0,0,canvas.width,canvas.height);ctx.drawImage(video,0,0,canvas.width,canvas.height);if(result.faceDetected){// Draw landmarks\nif(result.landmarks){drawLandmarks(ctx,result.landmarks,canvas.width,canvas.height,result.status==='alert');}// Update UI based on status\nif(result.status==='calibrating'){setProgress(result.progress);setMessage(\"Calibrando... \".concat(Math.round(result.progress),\"%\"));}else if(result.status==='ok'||result.status==='alert'){// Calibration complete\nfinishCalibration();return;}}else{setMessage('Nenhum rosto detectado - centralize seu rosto');}// Continue loop\nanimationFrameRef.current=requestAnimationFrame(detectLoop);}catch(err){console.error('Detection error:',err);setError(err.message);setStatus('error');}};const finishCalibration=async()=>{if(!faceDetectorRef.current)return;try{// Get baseline data\nconst data=faceDetectorRef.current.getBaselineData();setBaselineData(data);// Save to context\nsetBaselineFace(data);setStatus('complete');setMessage('Calibra√ß√£o completa!');setProgress(100);// Stop animation loop\nif(animationFrameRef.current){cancelAnimationFrame(animationFrameRef.current);}}catch(err){console.error('Failed to finish calibration:',err);setError(err.message);setStatus('error');}};const handleContinue=()=>{cleanup();navigate('/profile-created');};const handleRetry=()=>{if(faceDetectorRef.current){faceDetectorRef.current.reset();}setStatus('ready');setProgress(0);setMessage('Pronto para iniciar');setError(null);setBaselineData(null);};const cleanup=()=>{// Stop animation loop\nif(animationFrameRef.current){cancelAnimationFrame(animationFrameRef.current);}// Stop camera stream\nif(streamRef.current){streamRef.current.getTracks().forEach(track=>track.stop());}// Cleanup face detector\nif(faceDetectorRef.current){faceDetectorRef.current.cleanup();}};// Render states\nif(status==='init'){return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:message})]});}if(status==='error'){return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"icon danger\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Erro\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-danger\",children:error}),/*#__PURE__*/_jsx(\"button\",{className:\"button\",onClick:initializeCamera,children:\"TENTAR NOVAMENTE\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button white mt-2\",onClick:()=>navigate(-1),children:\"VOLTAR\"})]});}if(status==='complete'&&baselineData){return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"icon success\",children:\"\\u2713\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Calibra\\xE7\\xE3o Facial Completa!\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"card mt-3\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Perfil Facial Criado\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Baseline estabelecida:\"}),\" \",baselineData.mean.toFixed(4)]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Frames analisados:\"}),\" \",baselineData.frames]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mt-2\",children:\"Seu perfil facial foi salvo com sucesso. O sistema ir\\xE1 monitorar assimetrias faciais que podem indicar sinais de AVC.\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card mt-2 bg-info\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u2139\\uFE0F Importante:\"}),\" Durante o monitoramento, o sistema ir\\xE1 alert\\xE1-lo se detectar qualquer assimetria significativa em sua face.\"]})}),/*#__PURE__*/_jsx(\"button\",{className:\"button green mt-3\",onClick:handleContinue,children:\"CONTINUAR\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button white mt-2\",onClick:handleRetry,children:\"REFAZER CALIBRA\\xC7\\xC3O\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"progress-indicator\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"step\",children:\"1\"}),/*#__PURE__*/_jsx(\"div\",{className:\"step-line\"}),/*#__PURE__*/_jsx(\"div\",{className:\"step active\",children:\"2\"})]}),/*#__PURE__*/_jsx(\"h1\",{children:\"Calibra\\xE7\\xE3o Facial\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"Etapa 2 de 2 - Cria\\xE7\\xE3o do Perfil\"}),status==='ready'&&/*#__PURE__*/_jsxs(\"div\",{className:\"card mt-3\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Instru\\xE7\\xF5es\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-left\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"Posicione seu rosto centralizado na c\\xE2mera\"}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Mantenha uma express\\xE3o \",/*#__PURE__*/_jsx(\"strong\",{children:\"neutra e relaxada\"})]}),/*#__PURE__*/_jsx(\"li\",{children:\"Evite movimentar muito a cabe\\xE7a\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Mantenha boa ilumina\\xE7\\xE3o no ambiente\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mt-2\",children:/*#__PURE__*/_jsx(\"em\",{children:\"O processo levar\\xE1 cerca de 3-5 segundos\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"video-container mt-3\",children:[/*#__PURE__*/_jsx(\"video\",{ref:videoRef,autoPlay:true,playsInline:true,muted:true,style:{display:'none'}}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef}),status==='calibrating'&&/*#__PURE__*/_jsx(\"div\",{className:\"video-overlay\",children:/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'20px',left:'50%',transform:'translateX(-50%)',background:'rgba(0,0,0,0.7)',padding:'12px 24px',borderRadius:'8px',color:'white',fontWeight:'600'},children:message})})]}),status==='calibrating'&&/*#__PURE__*/_jsxs(\"div\",{className:\"card mt-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-fill\",style:{width:\"\".concat(progress,\"%\"),background:'var(--primary-purple)'}})}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-center text-muted mt-2\",children:[Math.round(progress),\"% completo\"]})]}),status==='ready'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"button purple mt-3\",onClick:handleStartCalibration,children:\"\\uD83D\\uDCF9 INICIAR CALIBRA\\xC7\\xC3O\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button white mt-2\",onClick:()=>navigate(-1),children:\"VOLTAR\"})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useRef","useNavigate","useApp","FaceDetector","drawLandmarks","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","FaceRecording","navigate","setBaselineFace","status","setStatus","progress","setProgress","message","setMessage","error","setError","baselineData","setBaselineData","videoRef","canvasRef","faceDetectorRef","streamRef","animationFrameRef","initializeCamera","cleanup","stream","navigator","mediaDevices","getUserMedia","video","facingMode","width","ideal","height","audio","current","srcObject","Promise","resolve","onloadedmetadata","play","videoWidth","videoHeight","init","err","console","handleStartCalibration","detectLoop","canvas","ctx","getContext","detector","timestamp","performance","now","result","detectFrame","clearRect","drawImage","faceDetected","landmarks","concat","Math","round","finishCalibration","requestAnimationFrame","data","getBaselineData","cancelAnimationFrame","handleContinue","handleRetry","reset","getTracks","forEach","track","stop","className","children","onClick","mean","toFixed","frames","ref","autoPlay","playsInline","muted","style","display","position","top","left","transform","background","padding","borderRadius","color","fontWeight"],"sources":["/home/hugorteixeira/AvisoVC/frontend/src/pages/FaceRecording.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useApp } from '../contexts/AppContext';\nimport { FaceDetector, drawLandmarks } from '../utils/faceDetection';\n\nexport default function FaceRecording() {\n  const navigate = useNavigate();\n  const { setBaselineFace } = useApp();\n\n  const [status, setStatus] = useState('init'); // init, ready, calibrating, complete, error\n  const [progress, setProgress] = useState(0);\n  const [message, setMessage] = useState('Inicializando c√¢mera...');\n  const [error, setError] = useState(null);\n  const [baselineData, setBaselineData] = useState(null);\n\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const faceDetectorRef = useRef(null);\n  const streamRef = useRef(null);\n  const animationFrameRef = useRef(null);\n\n  useEffect(() => {\n    initializeCamera();\n    return () => {\n      cleanup();\n    };\n  }, []);\n\n  const initializeCamera = async () => {\n    try {\n      // Request camera access\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'user',\n          width: { ideal: 720 },\n          height: { ideal: 540 },\n        },\n        audio: false,\n      });\n\n      streamRef.current = stream;\n\n      // Set video source\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n        await new Promise((resolve) => {\n          videoRef.current.onloadedmetadata = resolve;\n        });\n        await videoRef.current.play();\n\n        // Set canvas size\n        if (canvasRef.current) {\n          canvasRef.current.width = videoRef.current.videoWidth;\n          canvasRef.current.height = videoRef.current.videoHeight;\n        }\n      }\n\n      // Initialize face detector\n      setMessage('Carregando detector facial...');\n      faceDetectorRef.current = new FaceDetector();\n      await faceDetectorRef.current.init();\n\n      setStatus('ready');\n      setMessage('Pronto para iniciar');\n    } catch (err) {\n      console.error('Failed to initialize:', err);\n      setError(err.message || 'N√£o foi poss√≠vel acessar a c√¢mera');\n      setStatus('error');\n    }\n  };\n\n  const handleStartCalibration = () => {\n    if (!faceDetectorRef.current || !videoRef.current) {\n      setError('Sistema n√£o inicializado');\n      return;\n    }\n\n    setStatus('calibrating');\n    setProgress(0);\n    setMessage('Calibrando... Mantenha o rosto centralizado');\n\n    // Start detection loop\n    detectLoop();\n  };\n\n  const detectLoop = () => {\n    if (status === 'complete' || status === 'error') return;\n\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const ctx = canvas?.getContext('2d');\n    const detector = faceDetectorRef.current;\n\n    if (!video || !canvas || !ctx || !detector) return;\n\n    try {\n      const timestamp = performance.now();\n      const result = detector.detectFrame(video, timestamp);\n\n      // Clear canvas and draw video\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n      if (result.faceDetected) {\n        // Draw landmarks\n        if (result.landmarks) {\n          drawLandmarks(\n            ctx,\n            result.landmarks,\n            canvas.width,\n            canvas.height,\n            result.status === 'alert'\n          );\n        }\n\n        // Update UI based on status\n        if (result.status === 'calibrating') {\n          setProgress(result.progress);\n          setMessage(`Calibrando... ${Math.round(result.progress)}%`);\n        } else if (result.status === 'ok' || result.status === 'alert') {\n          // Calibration complete\n          finishCalibration();\n          return;\n        }\n      } else {\n        setMessage('Nenhum rosto detectado - centralize seu rosto');\n      }\n\n      // Continue loop\n      animationFrameRef.current = requestAnimationFrame(detectLoop);\n    } catch (err) {\n      console.error('Detection error:', err);\n      setError(err.message);\n      setStatus('error');\n    }\n  };\n\n  const finishCalibration = async () => {\n    if (!faceDetectorRef.current) return;\n\n    try {\n      // Get baseline data\n      const data = faceDetectorRef.current.getBaselineData();\n      setBaselineData(data);\n\n      // Save to context\n      setBaselineFace(data);\n\n      setStatus('complete');\n      setMessage('Calibra√ß√£o completa!');\n      setProgress(100);\n\n      // Stop animation loop\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n      }\n    } catch (err) {\n      console.error('Failed to finish calibration:', err);\n      setError(err.message);\n      setStatus('error');\n    }\n  };\n\n  const handleContinue = () => {\n    cleanup();\n    navigate('/profile-created');\n  };\n\n  const handleRetry = () => {\n    if (faceDetectorRef.current) {\n      faceDetectorRef.current.reset();\n    }\n    setStatus('ready');\n    setProgress(0);\n    setMessage('Pronto para iniciar');\n    setError(null);\n    setBaselineData(null);\n  };\n\n  const cleanup = () => {\n    // Stop animation loop\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current);\n    }\n\n    // Stop camera stream\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach((track) => track.stop());\n    }\n\n    // Cleanup face detector\n    if (faceDetectorRef.current) {\n      faceDetectorRef.current.cleanup();\n    }\n  };\n\n  // Render states\n  if (status === 'init') {\n    return (\n      <div className=\"container\">\n        <div className=\"spinner\"></div>\n        <p>{message}</p>\n      </div>\n    );\n  }\n\n  if (status === 'error') {\n    return (\n      <div className=\"container\">\n        <div className=\"icon danger\">‚ö†Ô∏è</div>\n        <h1>Erro</h1>\n        <p className=\"text-danger\">{error}</p>\n        <button className=\"button\" onClick={initializeCamera}>\n          TENTAR NOVAMENTE\n        </button>\n        <button className=\"button white mt-2\" onClick={() => navigate(-1)}>\n          VOLTAR\n        </button>\n      </div>\n    );\n  }\n\n  if (status === 'complete' && baselineData) {\n    return (\n      <div className=\"container\">\n        <div className=\"icon success\">‚úì</div>\n        <h1>Calibra√ß√£o Facial Completa!</h1>\n\n        <div className=\"card mt-3\">\n          <h3>Perfil Facial Criado</h3>\n          <div className=\"mt-2\">\n            <p><strong>Baseline estabelecida:</strong> {baselineData.mean.toFixed(4)}</p>\n            <p><strong>Frames analisados:</strong> {baselineData.frames}</p>\n            <p className=\"text-muted mt-2\">\n              Seu perfil facial foi salvo com sucesso. O sistema ir√° monitorar assimetrias\n              faciais que podem indicar sinais de AVC.\n            </p>\n          </div>\n        </div>\n\n        <div className=\"card mt-2 bg-info\">\n          <p className=\"mb-0\">\n            <strong>‚ÑπÔ∏è Importante:</strong> Durante o monitoramento, o sistema ir√° alert√°-lo\n            se detectar qualquer assimetria significativa em sua face.\n          </p>\n        </div>\n\n        <button className=\"button green mt-3\" onClick={handleContinue}>\n          CONTINUAR\n        </button>\n        <button className=\"button white mt-2\" onClick={handleRetry}>\n          REFAZER CALIBRA√á√ÉO\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container\">\n      <div className=\"progress-indicator\">\n        <div className=\"step\">1</div>\n        <div className=\"step-line\"></div>\n        <div className=\"step active\">2</div>\n      </div>\n\n      <h1>Calibra√ß√£o Facial</h1>\n      <p className=\"text-muted\">Etapa 2 de 2 - Cria√ß√£o do Perfil</p>\n\n      {status === 'ready' && (\n        <div className=\"card mt-3\">\n          <h3>Instru√ß√µes</h3>\n          <ul className=\"text-left\">\n            <li>Posicione seu rosto centralizado na c√¢mera</li>\n            <li>Mantenha uma express√£o <strong>neutra e relaxada</strong></li>\n            <li>Evite movimentar muito a cabe√ßa</li>\n            <li>Mantenha boa ilumina√ß√£o no ambiente</li>\n          </ul>\n          <p className=\"text-muted mt-2\">\n            <em>O processo levar√° cerca de 3-5 segundos</em>\n          </p>\n        </div>\n      )}\n\n      <div className=\"video-container mt-3\">\n        <video\n          ref={videoRef}\n          autoPlay\n          playsInline\n          muted\n          style={{ display: 'none' }}\n        />\n        <canvas ref={canvasRef} />\n\n        {status === 'calibrating' && (\n          <div className=\"video-overlay\">\n            <div style={{\n              position: 'absolute',\n              top: '20px',\n              left: '50%',\n              transform: 'translateX(-50%)',\n              background: 'rgba(0,0,0,0.7)',\n              padding: '12px 24px',\n              borderRadius: '8px',\n              color: 'white',\n              fontWeight: '600',\n            }}>\n              {message}\n            </div>\n          </div>\n        )}\n      </div>\n\n      {status === 'calibrating' && (\n        <div className=\"card mt-3\">\n          <div className=\"progress-bar\">\n            <div\n              className=\"progress-fill\"\n              style={{ width: `${progress}%`, background: 'var(--primary-purple)' }}\n            ></div>\n          </div>\n          <p className=\"text-center text-muted mt-2\">{Math.round(progress)}% completo</p>\n        </div>\n      )}\n\n      {status === 'ready' && (\n        <>\n          <button className=\"button purple mt-3\" onClick={handleStartCalibration}>\n            üìπ INICIAR CALIBRA√á√ÉO\n          </button>\n          <button className=\"button white mt-2\" onClick={() => navigate(-1)}>\n            VOLTAR\n          </button>\n        </>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}